CI_2.5  = vector(length = length(file_list)),
CI_97.5 = vector(length = length(file_list)),
delta   = vector(length = length(file_list)))
for(i in seq_along(file_list)) {
model <- read_rds(file_list[i])
hiatus_position <- model$segment_edges$position[model$segment_edges$hiatus]
storage$median[i] <- model$hiatus_durations |> median()
storage$CI_2.5[i] <- model$hiatus_durations |> quantile(prob = 0.025)
storage$CI_97.5[i] <- model$hiatus_durations |> quantile(prob = 0.975)
storage$delta[i] <- (model$geochron_data$position - hiatus_position) |>
abs() |>
min()
rm(model)
}
# load all the data -----------------------------------------------------------
two_ages <- list.files('./results/random_age_validation/CIP2_2_ages/',
full.names = TRUE,
pattern = '*.rds')
four_ages <- list.files('./results/random_age_validation/CIP2_4_ages/',
full.names = TRUE,
pattern = '*.rds')
six_ages <- list.files('./results/random_age_validation/CIP2_6_ages/',
full.names = TRUE,
pattern = '*.rds')
eight_ages <- list.files('./results/random_age_validation/CIP2_8_ages/',
full.names = TRUE,
pattern = '*.rds')
test <- c(two_ages, four_ages, six_ages, eight_ages)
all_tests <- c(two_ages, four_ages, six_ages, eight_ages)
all_tests
all_tests
# load all the data -----------------------------------------------------------
two_ages <- list.files('./results/random_age_validation/CIP2_2_ages',
full.names = TRUE,
pattern = '*.rds')
four_ages <- list.files('./results/random_age_validation/CIP2_4_ages',
full.names = TRUE,
pattern = '*.rds')
six_ages <- list.files('./results/random_age_validation/CIP2_6_ages',
full.names = TRUE,
pattern = '*.rds')
eight_ages <- list.files('./results/random_age_validation/CIP2_8_ages',
full.names = TRUE,
pattern = '*.rds')
all_tests <- c(two_ages, four_ages, six_ages, eight_ages)
storage <- data.frame(median  = vector(length = length(all_tests)),
CI_2.5  = vector(length = length(all_tests)),
CI_97.5 = vector(length = length(all_tests)),
delta   = vector(length = length(all_tests)))
View(storage)
storage <- data.frame(median  = vector(length = length(all_tests)),
CI_2.5  = vector(length = length(all_tests)),
CI_97.5 = vector(length = length(all_tests)),
delta   = vector(length = length(all_tests)),
n_ages  = rep(c(2,4,6,8), each = 1000))
View(storage)
storage <- data.frame(median  = vector(length = length(all_tests)),
CI_2.5  = vector(length = length(all_tests)),
CI_97.5 = vector(length = length(all_tests)),
delta   = vector(length = length(all_tests)),
n_ages  = rep(c(2,4,6,8), each = length(all_tests/4)))
storage <- data.frame(median  = vector(length = length(all_tests)),
CI_2.5  = vector(length = length(all_tests)),
CI_97.5 = vector(length = length(all_tests)),
delta   = vector(length = length(all_tests)),
n_ages  = rep(c(2,4,6,8), each = length(all_tests)/4))
rm(list = ls())
# load required libraries -----------------------------------------------------
library(tidyverse)
library(astroBayes)
theme_set(theme_minimal())
# load all the data -----------------------------------------------------------
two_ages <- list.files('./results/random_age_validation/CIP2_2_ages',
full.names = TRUE,
pattern = '*.rds')
four_ages <- list.files('./results/random_age_validation/CIP2_4_ages',
full.names = TRUE,
pattern = '*.rds')
six_ages <- list.files('./results/random_age_validation/CIP2_6_ages',
full.names = TRUE,
pattern = '*.rds')
eight_ages <- list.files('./results/random_age_validation/CIP2_8_ages',
full.names = TRUE,
pattern = '*.rds')
file_list <- c(two_ages, four_ages, six_ages, eight_ages)
storage <- data.frame(median  = vector(length = length(file_list)),
CI_2.5  = vector(length = length(file_list)),
CI_97.5 = vector(length = length(file_list)),
delta   = vector(length = length(file_list)),
n_ages  = rep(c(2,4,6,8), each = length(file_list)/4))
for(i in seq_along(file_list)) {
model <- read_rds(file_list[i])
hiatus_position <- model$segment_edges$position[model$segment_edges$hiatus]
storage$median[i] <- model$hiatus_durations |> median()
storage$CI_2.5[i] <- model$hiatus_durations |> quantile(prob = 0.025)
storage$CI_97.5[i] <- model$hiatus_durations |> quantile(prob = 0.975)
storage$delta[i] <- (model$geochron_data$position - hiatus_position) |>
abs() |>
min()
rm(model)
}
View(storage)
storage |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5)) +
geom_pointrange()
storage |>
filter(median == 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5)) +
geom_pointrange()
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5)) +
geom_pointrange()
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5)) +
geom_pointrange(alpha = 0.1)
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5,
color = n_ages)) +
geom_pointrange(alpha = 0.1)
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5,
color = factor(n_ages))) +
geom_pointrange(alpha = 0.1)
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5,
color = factor(n_ages))) +
geom_pointrange(alpha = 0.1) +
facet_grid(~n_ages)
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5,
color = factor(n_ages))) +
geom_pointrange(alpha = 0.1) +
facet_wrap(~n_ages)
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5,
color = factor(n_ages))) +
geom_pointrange(alpha = 0.1) +
ylim(0, 0.5) +
facet_wrap(~n_ages)
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5,
color = factor(n_ages))) +
geom_pointrange(alpha = 0.1) +
ylim(0, 0.4) +
facet_wrap(~n_ages)
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5,
color = factor(n_ages))) +
geom_pointrange(alpha = 0.1) +
ylim(0, 0.4) +
facet_wrap(~n_ages) +
geom_hline(yintercept = 0.2025)
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5,
color = factor(n_ages))) +
geom_pointrange(alpha = 0.1) +
ylim(0, 0.4) +
facet_wrap(~n_ages) +
geom_hline(yintercept = 0.2025,
linetype = 'dashed')
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5,
color = factor(n_ages))) +
geom_pointrange(alpha = 0.1) +
ylim(0, 0.4) +
facet_wrap(~n_ages) +
geom_hline(yintercept = 0.2025,
linetype = 'dashed') +
xlab('stratigraphic distance to closest date')
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5,
color = factor(n_ages))) +
geom_pointrange(alpha = 0.1) +
ylim(0, 0.4) +
facet_wrap(~n_ages) +
geom_hline(yintercept = 0.2025,
linetype = 'dashed') +
xlab('stratigraphic distance to closest date') +
ylab('hiatus (Ma)')
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5,
color = factor(n_ages))) +
geom_pointrange(alpha = 0.1, show.legend = FALSE) +
ylim(0, 0.4) +
facet_wrap(~n_ages) +
geom_hline(yintercept = 0.2025,
linetype = 'dashed') +
xlab('stratigraphic distance to closest date') +
ylab('hiatus (Ma)')
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5,
color = factor(n_ages))) +
geom_pointrange(alpha = 0.1, show.legend = FALSE) +
ylim(0, 0.4) +
facet_wrap(~n_ages) +
geom_hline(yintercept = 0.2025,
linetype = 'dashed') +
xlab(expression(Delta~hiatus-date)) +
ylab('hiatus (Ma)')
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5,
color = factor(n_ages))) +
geom_pointrange(alpha = 0.1, show.legend = FALSE) +
ylim(0, 0.4) +
facet_wrap(~n_ages) +
geom_hline(yintercept = 0.2025,
linetype = 'dashed') +
xlab(expression(Delta~'hiatus-date')) +
ylab('hiatus (Ma)')
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5,
color = factor(n_ages))) +
geom_pointrange(alpha = 0.1, show.legend = FALSE) +
ylim(0, 0.4) +
facet_wrap(~n_ages) +
geom_hline(yintercept = 0.2025,
linetype = 'dashed') +
xlab(expression(delta~'hiatus-date')) +
ylab('hiatus (Ma)')
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5,
color = factor(n_ages))) +
geom_pointrange(alpha = 0.1, show.legend = FALSE) +
ylim(0, 0.4) +
facet_wrap(~n_ages) +
geom_hline(yintercept = 0.2025,
linetype = 'dashed') +
xlab(expression(delta*'hiatus-date')) +
ylab('hiatus (Ma)')
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5,
color = factor(n_ages))) +
geom_pointrange(alpha = 0.1, show.legend = FALSE) +
ylim(0, 0.4) +
facet_wrap(~n_ages) +
geom_hline(yintercept = 0.2025,
linetype = 'dashed') +
xlab(expression(Delta*'hiatus-date')) +
ylab('hiatus (Ma)')
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5,
color = factor(n_ages))) +
geom_pointrange(alpha = 0.1, show.legend = FALSE) +
ylim(0, 0.4) +
facet_wrap(~n_ages) +
geom_hline(yintercept = 0.2025,
linetype = 'dashed') +
xlab(expression(Delta*['hiatus-date'])) +
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5,
color = factor(n_ages))) +
geom_pointrange(alpha = 0.1, show.legend = FALSE) +
ylim(0, 0.4) +
facet_wrap(~n_ages) +
geom_hline(yintercept = 0.2025,
linetype = 'dashed') +
xlab(expression(Delta*'hiatus-date (m)')) +
ylab('hiatus (Ma)')
# load required libraries -----------------------------------------------------
library(tidyverse)
library(astroBayes)
theme_set(theme_minimal())
# load all the data -----------------------------------------------------------
two_ages <- list.files('./results/random_age_validation/CIP2_2_ages',
full.names = TRUE,
pattern = '*.rds')
four_ages <- list.files('./results/random_age_validation/CIP2_4_ages',
full.names = TRUE,
pattern = '*.rds')
six_ages <- list.files('./results/random_age_validation/CIP2_6_ages',
full.names = TRUE,
pattern = '*.rds')
eight_ages <- list.files('./results/random_age_validation/CIP2_8_ages',
full.names = TRUE,
pattern = '*.rds')
file_list <- c(two_ages, four_ages, six_ages, eight_ages)
storage <- data.frame(median  = vector(length = length(file_list)),
CI_2.5  = vector(length = length(file_list)),
CI_97.5 = vector(length = length(file_list)),
delta   = vector(length = length(file_list)),
n_ages  = rep(c('2 ages','4 ages','6 ages','8 ages'), each = length(file_list)/4))
for(i in seq_along(file_list)) {
model <- read_rds(file_list[i])
hiatus_position <- model$segment_edges$position[model$segment_edges$hiatus]
storage$median[i] <- model$hiatus_durations |> median()
storage$CI_2.5[i] <- model$hiatus_durations |> quantile(prob = 0.025)
storage$CI_97.5[i] <- model$hiatus_durations |> quantile(prob = 0.975)
storage$delta[i] <- (model$geochron_data$position - hiatus_position) |>
abs() |>
min()
rm(model)
}
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5,
color = factor(n_ages))) +
geom_pointrange(alpha = 0.1, show.legend = FALSE) +
ylim(0, 0.4) +
facet_wrap(~n_ages) +
geom_hline(yintercept = 0.2025,
linetype = 'dashed') +
xlab(expression(Delta*'hiatus-date (m)')) +
ylab('hiatus (Ma)')
library(viridis)
storage |>
mutate(diff = median - 0.2025)
storage <- storage |>
mutate(diff = median - 0.2025)
storage |>
group_by(n_ages) |>
summarize(mean = mean(diff))
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5,
color = factor(n_ages))) +
geom_pointrange(alpha = 0.1, show.legend = FALSE) +
ylim(0, 0.4) +
facet_wrap(~n_ages) +
geom_hline(yintercept = 0.2025,
linetype = 'dashed') +
xlab(expression(Delta*'hiatus-date (m)')) +
ylab('hiatus (Ma)')
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5,
color = factor(n_ages))) +
geom_pointrange(alpha = 0.1, show.legend = FALSE) +
ylim(0, 0.4) +
facet_wrap(~n_ages) +
geom_hline(yintercept = 0.2025,
linetype = 'dashed') +
xlab(expression(Delta*'hiatus-date (m)')) +
ylab('hiatus (Ma)') +
scale_color_viridis(option = 'plasma')
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5,
color = factor(n_ages))) +
geom_pointrange(alpha = 0.1, show.legend = FALSE) +
ylim(0, 0.4) +
facet_wrap(~n_ages) +
geom_hline(yintercept = 0.2025,
linetype = 'dashed') +
xlab(expression(Delta*'hiatus-date (m)')) +
ylab('hiatus (Ma)') +
scale_color_viridis(option = 'plasma',
discrete = TRUE)
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5,
color = factor(n_ages))) +
geom_pointrange(alpha = 0.1, show.legend = FALSE) +
ylim(0, 0.4) +
facet_wrap(~n_ages) +
geom_hline(yintercept = 0.2025,
linetype = 'dashed') +
xlab(expression(Delta*'hiatus-date (m)')) +
ylab('hiatus (Ma)') +
scale_color_viridis(option = 'magma',
discrete = TRUE)
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5,
color = factor(n_ages))) +
geom_pointrange(alpha = 0.1, show.legend = FALSE) +
ylim(0, 0.4) +
facet_wrap(~n_ages) +
geom_hline(yintercept = 0.2025,
linetype = 'dashed') +
xlab(expression(Delta*'hiatus-date (m)')) +
ylab('hiatus (Ma)') +
scale_color_viridis(option = 'plasma',
discrete = TRUE,
end = 0.1)
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5,
color = factor(n_ages))) +
geom_pointrange(alpha = 0.1, show.legend = FALSE) +
ylim(0, 0.4) +
facet_wrap(~n_ages) +
geom_hline(yintercept = 0.2025,
linetype = 'dashed') +
xlab(expression(Delta*'hiatus-date (m)')) +
ylab('hiatus (Ma)') +
scale_color_viridis(option = 'plasma',
discrete = TRUE,
end = 0.8)
storage |>
filter(median != 0) |>
ggplot(mapping = aes(x = delta,
y = median,
ymax = CI_97.5,
ymin = CI_2.5,
color = factor(n_ages))) +
geom_pointrange(alpha = 0.1, show.legend = FALSE) +
ylim(0, 0.4) +
facet_wrap(~n_ages) +
geom_hline(yintercept = 0.2025,
linetype = 'dashed') +
xlab(expression(Delta*'hiatus-date (m)')) +
ylab('hiatus duration (Ma)') +
scale_color_viridis(option = 'plasma',
discrete = TRUE,
end = 0.8)
